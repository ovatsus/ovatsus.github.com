
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Functional Flow</title>
  <meta name="author" content="Gustavo Guerra">

  
  <meta name="description" content="Classes By now, mostly everyone already knows how to change the internal representation of a class without breaking compatibility. In C#: 1
2
3
4
5
6 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.codebeside.org/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/FunctionalFlow" rel="alternate" title="Functional Flow" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-5385973-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Functional Flow</a></h1>
  
  <div style="float:right; margin-top:20px; margin-right:20px">
    <a href="http://feeds.feedburner.com/FunctionalFlow" title="subscribe via RSS"><img src="/images/ico_rss.png" /></a>
  </div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <!--<li><a href="http://feeds.feedburner.com/FunctionalFlow" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>-->
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.codebeside.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="http://www.google.com/recaptcha/mailhide/d?k=01fvxbLCjfbApKdVLPRXZpew==&c=-9MautyEaQLUV3lZJtarnYj7m_iIE1vmrl9MSiLGGbg=">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/22/maintaining-backwards-compatibility-when-changing-apis-in-fsharp">Maintaining Backwards Compatibility When Changing APIs in F#</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-22T18:41:00+00:00" pubdate data-updated="true">Mar 22<span>nd</span>, 2014</time>
        
         | <a href="/blog/2014/03/22/maintaining-backwards-compatibility-when-changing-apis-in-fsharp#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Classes</h3>

<p>By now, mostly everyone already knows how to change the internal representation of a class without breaking compatibility. In C#:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="c1">// Before</span>
</span><span class='line'><span class="k">class</span> <span class="nc">Rectangle</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="n">Point</span> <span class="n">TopLeft</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="n">Point</span> <span class="n">BottomRight</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="nf">Rectangle</span><span class="p">(</span><span class="n">Point</span> <span class="n">topLeft</span><span class="p">,</span> <span class="n">Point</span> <span class="n">bottomRight</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">TopLeft</span> <span class="p">=</span> <span class="n">topLeft</span><span class="p">;</span>
</span><span class='line'>        <span class="n">BottomRight</span> <span class="p">=</span> <span class="n">bottomRight</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// After</span>
</span><span class='line'><span class="k">class</span> <span class="nc">Rectangle</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="n">Point</span> <span class="n">TopLeft</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="n">Point</span> <span class="n">Size</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="nf">Rectangle</span><span class="p">(</span><span class="n">Point</span> <span class="n">topLeft</span><span class="p">,</span> <span class="n">Size</span> <span class="n">size</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">TopLeft</span> <span class="p">=</span> <span class="n">topLeft</span><span class="p">;</span>
</span><span class='line'>        <span class="n">Size</span> <span class="p">=</span> <span class="n">size</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// for backwards compatibility:</span>
</span><span class='line'>    <span class="k">public</span> <span class="nf">Rectangle</span><span class="p">(</span><span class="n">Point</span> <span class="n">topLeft</span><span class="p">,</span> <span class="n">Point</span> <span class="n">bottomRight</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">TopLeft</span> <span class="p">=</span> <span class="n">topLeft</span><span class="p">;</span>
</span><span class='line'>        <span class="n">Size</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Size</span><span class="p">(</span><span class="n">bottomRight</span><span class="p">.</span><span class="n">X</span> <span class="p">-</span> <span class="n">topLeft</span><span class="p">.</span><span class="n">X</span><span class="p">,</span> <span class="n">bottomRight</span><span class="p">.</span><span class="n">Y</span> <span class="p">-</span> <span class="n">topLeft</span><span class="p">.</span><span class="n">Y</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// for backwards compatibility:</span>
</span><span class='line'>    <span class="k">public</span> <span class="n">Point</span> <span class="n">BottomRight</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="k">new</span> <span class="n">Point</span><span class="p">(</span><span class="n">TopLeft</span><span class="p">.</span><span class="n">X</span> <span class="p">+</span> <span class="n">Size</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">TopLeft</span><span class="p">.</span><span class="n">Y</span> <span class="p">+</span> <span class="n">Size</span><span class="p">.</span><span class="n">Height</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>and in F#:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="c1">// Before</span>
</span><span class='line'><span class="k">type</span> <span class="nc">Rectangle</span><span class="o">(</span><span class="n">topLeft</span><span class="o">:</span><span class="nc">Point</span><span class="o">,</span> <span class="n">bottomRight</span><span class="o">:</span><span class="nc">Point</span><span class="o">)</span> <span class="o">=</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">member</span> <span class="o">__.</span><span class="nc">TopLeft</span> <span class="o">=</span> <span class="n">topLeft</span>
</span><span class='line'>    <span class="k">member</span> <span class="o">__.</span><span class="nc">BottomRight</span> <span class="o">=</span> <span class="n">bottomRight</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// After</span>
</span><span class='line'><span class="k">type</span> <span class="nc">Rectangle</span><span class="o">(</span><span class="n">topLeft</span><span class="o">:</span><span class="nc">Point</span><span class="o">,</span> <span class="n">size</span><span class="o">:</span><span class="nc">Size</span><span class="o">)</span> <span class="o">=</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">member</span> <span class="o">__.</span><span class="nc">TopLeft</span> <span class="o">=</span> <span class="n">topLeft</span>
</span><span class='line'>    <span class="k">member</span> <span class="o">__.</span><span class="nc">Size</span> <span class="o">=</span> <span class="n">size</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// for backwards compatibility:</span>
</span><span class='line'>    <span class="k">new</span> <span class="o">(</span><span class="n">topLeft</span><span class="o">:</span><span class="nc">Point</span><span class="o">,</span> <span class="n">bottomRight</span><span class="o">:</span><span class="nc">Point</span><span class="o">)</span> <span class="o">=</span>
</span><span class='line'>        <span class="nc">Rectangle</span><span class="o">(</span><span class="n">topLeft</span><span class="o">,</span> <span class="nc">Point</span><span class="o">(</span><span class="n">bottomRight</span><span class="o">.</span><span class="nc">X</span> <span class="o">-</span> <span class="n">topLeft</span><span class="o">.</span><span class="nc">X</span><span class="o">,</span> <span class="n">bottomRight</span><span class="o">.</span><span class="nc">Y</span> <span class="o">-</span> <span class="n">topLeft</span><span class="o">.</span><span class="nc">Y</span><span class="o">))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// for backwards compatibility:</span>
</span><span class='line'>    <span class="k">member</span> <span class="o">__.</span><span class="nc">BottomRight</span> <span class="o">=</span>
</span><span class='line'>        <span class="nc">Point</span><span class="o">(</span><span class="n">topLeft</span><span class="o">.</span><span class="nc">X</span> <span class="o">+</span> <span class="n">size</span><span class="o">.</span><span class="nc">Width</span><span class="o">,</span> <span class="n">topLeft</span><span class="o">.</span><span class="nc">Y</span> <span class="o">+</span> <span class="n">size</span><span class="o">.</span><span class="nc">Height</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Records</h3>

<p>When using record types, things are a little bit more tricky, though:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="c1">// Before</span>
</span><span class='line'><span class="k">type</span> <span class="nc">Rectangle</span> <span class="o">=</span>
</span><span class='line'>    <span class="o">{</span> <span class="nc">TopLeft</span> <span class="o">:</span> <span class="nc">Point</span>
</span><span class='line'>      <span class="nc">BottomRight</span> <span class="o">:</span> <span class="nc">Point</span> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// After</span>
</span><span class='line'><span class="k">type</span> <span class="nc">Rectangle</span> <span class="o">=</span>
</span><span class='line'>    <span class="o">{</span> <span class="nc">TopLeft</span> <span class="o">:</span> <span class="nc">Point</span>
</span><span class='line'>      <span class="nc">Size</span> <span class="o">:</span> <span class="nc">Size</span> <span class="o">}</span>
</span><span class='line'>    <span class="k">member</span> <span class="n">x</span><span class="o">.</span><span class="nc">BottomRight</span> <span class="o">=</span>
</span><span class='line'>        <span class="nc">Point</span><span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="nn">TopLeft</span><span class="p">.</span><span class="nc">X</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="nn">Size</span><span class="p">.</span><span class="nc">Width</span><span class="o">,</span> <span class="n">x</span><span class="o">.</span><span class="nn">TopLeft</span><span class="p">.</span><span class="nc">Y</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="nn">Size</span><span class="p">.</span><span class="nc">Height</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This change will keep working at the usages of Rectangle, but not at creation, as there isn&#8217;t a way (at least that I know of) to make something like <code>{ TopLeft = Point(2.5, 3.0); BottomRight = Point(4.0, 7.5) }</code> keep working. This can be avoided if we originally had hidden the fact that Rectangle was representation as a record, like this:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">type</span> <span class="nc">Rectangle</span> <span class="o">=</span>
</span><span class='line'>    <span class="k">private</span> <span class="o">{</span> <span class="nc">TL</span> <span class="o">:</span> <span class="nc">Point</span>
</span><span class='line'>              <span class="nc">BR</span> <span class="o">:</span> <span class="nc">Point</span> <span class="o">}</span>
</span><span class='line'>    <span class="k">member</span> <span class="n">x</span><span class="o">.</span><span class="nc">TopLeft</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="nc">TL</span>
</span><span class='line'>    <span class="k">member</span> <span class="n">x</span><span class="o">.</span><span class="nc">BottomRight</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="nc">BR</span>
</span><span class='line'>    <span class="k">static</span> <span class="k">member</span> <span class="nc">Create</span><span class="o">(</span><span class="n">topLeft</span><span class="o">,</span> <span class="n">bottomRight</span><span class="o">)</span> <span class="o">=</span>
</span><span class='line'>        <span class="o">{</span> <span class="nc">TL</span> <span class="o">=</span> <span class="n">topLeft</span><span class="o">;</span> <span class="nc">BR</span> <span class="o">=</span> <span class="n">bottomRight</span> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>But for me this seems to defeat some of the advantages of using a record in the first place. You still get structural equality and pretty printing for free, which classes don&#8217;t have, but you lose the nice pattern matching and type inference capabilities that usually come with records.</p>

<h3>Single case discriminated unions</h3>

<p>The situation for discriminated unions is better, though. For each changed case, you can use one active pattern and a function to maintain backward compatibility:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="c1">// Before</span>
</span><span class='line'><span class="k">type</span> <span class="nc">Rectangle</span> <span class="o">=</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Rectange</span> <span class="k">of</span> <span class="n">topLeft</span><span class="o">:</span><span class="nc">Point</span> <span class="o">*</span> <span class="n">bottomRight</span><span class="o">:</span><span class="nc">Point</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// After</span>
</span><span class='line'><span class="k">type</span> <span class="nc">Rectangle</span> <span class="o">=</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Rectangle2</span> <span class="k">of</span> <span class="n">topLeft</span><span class="o">:</span><span class="nc">Point</span> <span class="o">*</span> <span class="n">size</span><span class="o">:</span><span class="nc">Size</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// for backwards compatibility:</span>
</span><span class='line'><span class="k">let</span> <span class="o">(|</span><span class="nc">Rectangle</span><span class="o">|)</span> <span class="n">x</span> <span class="o">=</span>
</span><span class='line'>    <span class="k">match</span> <span class="n">x</span> <span class="k">with</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Rectangle2</span><span class="o">(</span><span class="n">topLeft</span><span class="o">,</span> <span class="n">size</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">topLeft</span><span class="o">,</span> <span class="nc">Point</span><span class="o">(</span><span class="n">topLeft</span><span class="o">.</span><span class="nc">X</span> <span class="o">+</span> <span class="n">size</span><span class="o">.</span><span class="nc">Width</span><span class="o">,</span> <span class="n">topLeft</span><span class="o">.</span><span class="nc">Y</span> <span class="o">+</span> <span class="n">size</span><span class="o">.</span><span class="nc">Height</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// for backwards compatibility:</span>
</span><span class='line'><span class="k">let</span> <span class="nc">Rectangle</span><span class="o">(</span><span class="n">topLeft</span><span class="o">:</span><span class="nc">Point</span><span class="o">,</span> <span class="n">bottomRight</span><span class="o">:</span><span class="nc">Point</span><span class="o">)</span> <span class="o">=</span>
</span><span class='line'>    <span class="nc">Rectangle2</span><span class="o">(</span><span class="n">topLeft</span><span class="o">,</span> <span class="nc">Size</span><span class="o">(</span><span class="n">bottomRight</span><span class="o">.</span><span class="nc">X</span> <span class="o">-</span> <span class="n">topLeft</span><span class="o">.</span><span class="nc">X</span><span class="o">,</span> <span class="n">bottomRight</span><span class="o">.</span><span class="nc">Y</span> <span class="o">-</span> <span class="n">topLeft</span><span class="o">.</span><span class="nc">Y</span><span class="o">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>The downside is that the new discriminated union case has to have a new name, otherwise the function for backward compatibility will shadow the case constructor. This might not necessarily be a bad thing, though.</p>

<p>We could also make the discriminated union representation private, like we did for the record:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">type</span> <span class="nc">Rectangle</span> <span class="o">=</span>
</span><span class='line'>    <span class="k">private</span> <span class="o">|</span> <span class="nc">Rectangle</span> <span class="k">of</span> <span class="n">topLeft</span><span class="o">:</span><span class="nc">Point</span> <span class="o">*</span> <span class="n">bottomRight</span><span class="o">:</span><span class="nc">Point</span>
</span><span class='line'>    <span class="k">member</span> <span class="n">x</span><span class="o">.</span><span class="nc">TopLeft</span> <span class="o">=</span>
</span><span class='line'>        <span class="k">match</span> <span class="n">x</span> <span class="k">with</span>
</span><span class='line'>        <span class="o">|</span> <span class="nc">Rectangle</span><span class="o">(</span><span class="n">topLeft</span><span class="o">,</span> <span class="o">_)</span> <span class="o">-&gt;</span> <span class="n">topLeft</span>
</span><span class='line'>    <span class="k">member</span> <span class="n">x</span><span class="o">.</span><span class="nc">BottomRight</span> <span class="o">=</span>
</span><span class='line'>        <span class="k">match</span> <span class="n">x</span> <span class="k">with</span>
</span><span class='line'>        <span class="o">|</span> <span class="nc">Rectangle</span><span class="o">(_,</span> <span class="n">bottomRight</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">bottomRight</span>
</span><span class='line'>    <span class="k">static</span> <span class="k">member</span> <span class="nc">Create</span><span class="o">(</span><span class="n">topLeft</span><span class="o">,</span> <span class="n">bottomRight</span><span class="o">)</span> <span class="o">=</span>
</span><span class='line'>        <span class="nc">Rectangle</span><span class="o">(</span><span class="n">topLeft</span><span class="o">,</span> <span class="n">bottomRight</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>When we&#8217;re deciding between using a record or a single case discriminated union, these considerations might help decide.</p>

<h3>Multiple case discriminated unions</h3>

<p>When we have discriminated unions with multiple cases, the same technique also applies, but now we need to use partial active patterns instead (<code>(|Pattern|_|)</code> returning an option instead of <code>(|Pattern|)</code> returning the type directly). Here&#8217;s an example:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="c1">// Before</span>
</span><span class='line'><span class="o">[&lt;</span><span class="nc">RequireQualifiedAccess</span><span class="o">&gt;]</span>
</span><span class='line'><span class="k">type</span> <span class="nc">JsonValue</span> <span class="o">=</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">String</span> <span class="k">of</span> <span class="kt">string</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Number</span> <span class="k">of</span> <span class="kt">decimal</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Float</span> <span class="k">of</span> <span class="kt">float</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Object</span> <span class="k">of</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">,</span> <span class="nc">JsonValue</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Array</span> <span class="k">of</span> <span class="nc">JsonValue</span><span class="bp">[]</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Boolean</span> <span class="k">of</span> <span class="kt">bool</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Null</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// After</span>
</span><span class='line'><span class="o">[&lt;</span><span class="nc">RequireQualifiedAccess</span><span class="o">&gt;]</span>
</span><span class='line'><span class="k">type</span> <span class="nc">JsonValue</span> <span class="o">=</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">String</span> <span class="k">of</span> <span class="kt">string</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Number</span> <span class="k">of</span> <span class="kt">decimal</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Float</span> <span class="k">of</span> <span class="kt">float</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Record</span> <span class="k">of</span> <span class="n">properties</span><span class="o">:(</span><span class="kt">string</span><span class="o">*</span><span class="nc">JsonValue</span><span class="o">)</span><span class="bp">[]</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Array</span> <span class="k">of</span> <span class="n">elements</span><span class="o">:</span><span class="nc">JsonValue</span><span class="bp">[]</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Boolean</span> <span class="k">of</span> <span class="kt">bool</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Null</span>
</span><span class='line'>
</span><span class='line'><span class="o">[&lt;</span><span class="nc">CompilationRepresentation</span><span class="o">(</span><span class="nn">CompilationRepresentationFlags</span><span class="p">.</span><span class="nc">ModuleSuffix</span><span class="o">)&gt;]</span>
</span><span class='line'><span class="k">module</span> <span class="nc">JsonValue</span> <span class="o">=</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">[&lt;</span><span class="nc">Obsolete</span><span class="o">(</span><span class="s2">&quot;Please use JsonValue.Record instead&quot;</span><span class="o">)&gt;]</span>
</span><span class='line'>    <span class="k">let</span> <span class="o">(|</span><span class="nc">Object</span><span class="o">|_|)</span> <span class="n">x</span> <span class="o">=</span>
</span><span class='line'>        <span class="k">match</span> <span class="n">x</span> <span class="k">with</span>
</span><span class='line'>        <span class="o">|</span> <span class="nn">JsonValue</span><span class="p">.</span><span class="nc">Record</span> <span class="n">properties</span> <span class="o">-&gt;</span> <span class="nn">Map</span><span class="p">.</span><span class="n">ofArray</span> <span class="n">properties</span> <span class="o">|&gt;</span> <span class="nc">Some</span>
</span><span class='line'>        <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="nc">None</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">[&lt;</span><span class="nc">Obsolete</span><span class="o">(</span><span class="s2">&quot;Please use JsonValue.Record instead&quot;</span><span class="o">)&gt;]</span>
</span><span class='line'>    <span class="k">let</span> <span class="nc">Object</span> <span class="o">=</span> <span class="nn">Map</span><span class="p">.</span><span class="n">toArray</span> <span class="o">&gt;&gt;</span> <span class="nn">JsonValue</span><span class="p">.</span><span class="nc">Record</span>
</span></code></pre></td></tr></table></div></figure>


<p>In this example, because <code>[&lt;RequireQualifiedAccess&gt;]</code> was being used, we have to include the active pattern and the compatibility function in a module, and use <code>[&lt;CompilationRepresentation(CompilationRepresentationFlags.ModuleSuffix)&gt;]</code> to be able to maintain the exact same syntax. We also marked the backward compatibility constructs with the <code>Obsolete</code> attribute because we don&#8217;t want new users to be using the old discriminated union case. This attribute will make sure the old case doesn&#8217;t show up in IntelliSense, and will also issue a warning to old users.</p>

<p>There&#8217;s one extra caveat, though. Consider the following code:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">let</span> <span class="n">f</span> <span class="n">x</span> <span class="o">=</span>
</span><span class='line'>    <span class="k">match</span> <span class="n">x</span> <span class="k">with</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">String</span> <span class="n">s</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Number</span> <span class="n">n</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Float</span> <span class="n">f</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Object</span> <span class="n">properties</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Array</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Boolean</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Null</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span></code></pre></td></tr></table></div></figure>


<p>Even though we&#8217;re handling all the cases, we get a warning stating <strong>this pattern-matching is not exhaustive</strong>. This is because the compiler doesn&#8217;t know what <code>Object</code> will match on: it&#8217;s a custom defined partial active pattern, so the implementation could match on multiple cases or even none at all.</p>

<h3>Final thoughts</h3>

<p>In all of the above we were only concerned with source compatibility. Binary compatibility has other concerns that would require further exploration.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/21/fsharp-named-union-fields">F# Named Union Fields</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-21T22:37:00+00:00" pubdate data-updated="true">Mar 21<span>st</span>, 2014</time>
        
         | <a href="/blog/2014/03/21/fsharp-named-union-fields#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of the new features in F# 3.1, and one that I really like, is the possibility to name fields of discriminated unions. From the <a href="http://blogs.msdn.com/b/fsharpteam/archive/2013/06/27/announcing-a-pre-release-of-f-3-1-and-the-visual-f-tools-in-visual-studio-2013.aspx">F# 3.1 announcement blog post</a>:</p>

<blockquote><p>Discriminated union types are a powerful feature of F# which make programming with shaped data simple, accurate and robust. They also greatly reduce the number of classes needed to represent data in many common circumstances.</p>

<p>In F# 3.1, it is now possible to name union fields within each case of a union type. This is important for large-scale software engineering, particularly when union cases have a large number of fields or multiple fields with the same type.</p>

<p><img src="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-39-71-metablogapi/2021.31blog_5F00_1_5F00_0EEA8EAA.png" alt="" /></p></blockquote>

<p>What wasn&#8217;t originally mentioned on that post, I just found out today, is that pattern match by name is not limited to a single element of the case: we can match on multiple elements by separating them by <code>;</code>.</p>

<p>When we pattern match by position, the several elements are separated by <code>,</code>, and as that didn&#8217;t work with union field names, I assumed it wasn&#8217;t possible to do at all. But it turns out it is possible if you use <code>;</code> instead. Here&#8217;s an example taken from F# Data:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">type</span> <span class="nc">InferedType</span> <span class="o">=</span>
</span><span class='line'>  <span class="o">|</span> <span class="nc">Primitive</span> <span class="k">of</span> <span class="n">typ</span><span class="o">:</span><span class="nn">System</span><span class="p">.</span><span class="nc">Type</span> <span class="o">*</span> <span class="kt">unit</span><span class="o">:</span><span class="n">option</span><span class="o">&lt;</span><span class="nn">System</span><span class="p">.</span><span class="nc">Type</span><span class="o">&gt;</span> <span class="o">*</span> <span class="n">optional</span><span class="o">:</span><span class="kt">bool</span>
</span><span class='line'>  <span class="o">|</span> <span class="o">...</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// positional pattern match:</span>
</span><span class='line'><span class="k">match</span> <span class="n">x</span> <span class="k">with</span>
</span><span class='line'><span class="o">|</span> <span class="nc">Primitive</span><span class="o">(</span><span class="n">typ</span><span class="o">,</span> <span class="o">_,</span> <span class="bp">false</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span class='line'><span class="o">|</span> <span class="o">...</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// pattern match by name </span>
</span><span class='line'><span class="k">match</span> <span class="n">x</span> <span class="k">with</span>
</span><span class='line'><span class="o">|</span> <span class="nc">Primitive</span><span class="o">(</span><span class="n">typ</span> <span class="o">=</span> <span class="n">typ</span><span class="o">;</span> <span class="n">optional</span> <span class="o">=</span> <span class="bp">false</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span class='line'><span class="o">|</span> <span class="o">...</span>
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/10/fsharp-data-2-0-0-released">FSharp.Data 2.0.0 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-10T02:00:00+00:00" pubdate data-updated="true">Mar 10<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/03/10/fsharp-data-2-0-0-released#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Version <a href="http://www.nuget.org/packages/FSharp.Data/2.0.0">2.0.0</a> of <a href="http://fsharp.github.io/FSharp.Data/">FSharp.Data</a> was just released. You can get the full version history on the <a href="https://github.com/fsharp/FSharp.Data/blob/master/RELEASE_NOTES.md">release notes</a>, but here are the highlights:</p>

<ul>
<li>A new type inference algorithm that will generate better and more robust API&#8217;s in the presence of missing and heterogeneous types. This means that you&#8217;ll get much less errors when using JsonProvider and XmlProvider on real world messy files. The error messages are now also more descriptive when things go wrong.</li>
<li>Much improved Freebase support for individuals.</li>
<li>The functionality of the Http class was greatly extended. It now supports uploading and downloading binary files, and compression across all supported platforms, among many other tweaks.</li>
<li>Improved the overall performance of the type provider itself when running inside the editor, and also of the generated code.</li>
<li>The documentation was much improved, there&#8217;s now a Japanese translation of it, and comprehensive reference documentation.</li>
<li>Mono is now fully supported, as well as F# 3.1, and the new Portable Class Library profile 7.</li>
<li>Source link support. This means that you can step trough the source code while debugging if you enable that feature in Visual Studio.</li>
</ul>


<p>We also took the opportunity of major version bump to do some house cleaning, so things that we weren&#8217;t previously very happy with were renamed, dropped or, shuffled around. Unfortunately this means breaking changes, but we think the overall outcome is positive. In this process we dropped support for:</p>

<ul>
<li>Silverlight and Windows Phone separate packages.</li>
<li>Apiary provider (which has now moved to a <a href="https://github.com/fsprojects/ApiaryProvider">separate project</a>).</li>
</ul>


<p>Thanks to everyone which contributed directly to this release, <a href="http://github.com/tpetricek">Tomas Petricek</a>, <a href="http://github.com/dsyme">Don Syme</a>, <a href="http://github.com/forki">Steffen Forkmann</a>, <a href="http://github.com/enricosada">Enrico Sada</a>, <a href="http://github.com/ctaggart">Cameron Taggart</a>, <a href="http://github.com/remkoboschker">Remko Boschker</a>, <a href="http://github.com/vasily-kirichenko">Vasily Kirichenko</a>, <a href="http://github.com/diegofrata">Diego Frata</a>, <a href="http://github.com/yukitos">yukitos</a>, <a href="http://github.com/OkayX6">Denis Ok</a>, and <a href="http://github.com/jamesholwell">James Holwell</a>, and also to everyone who also contributed indirectly through yak-shaving needed in <a href="http://tpetricek.github.io/FSharp.Formatting">FSharp.Formatting</a>, <a href="http://fsharp.github.io/FSharp.Compiler.Service">FSharp.Compiler.Services</a>, and <a href="http://fsharp.github.io/FAKE">FAKE</a>, including <a href="http://github.com/7sharp9">Dave Thomas</a>, <a href="http://github.com/soloman817">Xiang Zhang</a>, <a href="http://github.com/dungpa">Anh-Dung Phan</a>, <a href="http://github.com/fbmnds">fbmnds</a>, and <a href="http://github.com/mexx">Max Malook</a>. And also thanks to everyone who contributed by just placing issues on github, but I couldn&#8217;t find a way to generate a list of all of you.</p>

<p>There&#8217;s still a lot of room for improvement, and we love pull requests, so please contribute, even if it&#8217;s only fixing a typo in the docs. A getting started guide is available <a href="http://fsharp.github.io/FSharp.Data/contributing.html">here</a>.</p>

<p>For the next versions, we want to add:</p>

<ul>
<li>Html type provider, currently being worked on by <a href="http://github.com/colinbull">Colin Bull</a>, <a href="http://github.com/mathias-brandewinder">Mathias Brandewinder</a> and me.</li>
<li>Write API for Json, currently being worked on by <a href="http://github.com/pezipink">Ross McKinlay</a>.</li>
<li>Authentication support, currently being worked on by <a href="http://github.com/veikkoeeva">Veikko Eeva</a>.</li>
<li>XSD support, which I hope one of you reading this will pick up :).</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/10/higher-order-list-operations-across-languages">Higher Order List Operations Across Languages</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-11-10T21:55:00+00:00" pubdate data-updated="true">Nov 10<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/11/10/higher-order-list-operations-across-languages#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Did this table out of curiosity, decided to share it:</p>

<pre>
----------------------------------------------------------------------------------------------
| F#         | C#         | Scala       | Clojure | Python | Ruby     | Haskell   | SQL      |
|------------|------------|-------------|---------|--------|----------|-----------|----------|
| map        | Select     | map         | map     | map    | collect  | map       | Select   |
| filter     | Where      | filter      | filter  | filter | select   | filter    | Where    |
| fold       | Aggregate  | foldLeft    | reduce  | reduce | inject   | foldl     |          |
| foldBack   |            | foldRight   |         |        |          | foldr     |          |
| reduce     | Aggregate  | reduceLeft  | reduce  | reduce | inject   | foldl1    |          |
| reduceBack |            | reduceRight |         |        |          | foldr1    |          |
| collect    | SelectMany | flatMap     | mapcat  |        | flat_map | concatMap | From     |
| exists     | Any        | exists      | some    | any    | any?     | any       | Exists   |
| forall     | All        | forall      | every?  | all    | all?     | all       |          |
| sortBy     | OrderBy    | sortBy      | sort-by | sorted | sort_by  | sortBy    | Order By |
----------------------------------------------------------------------------------------------
</pre>


<p>PS: please correct me if I got something wrong</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/14/fsharp-for-screen-scraping">F# for Screen Scraping</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-14T23:58:00+01:00" pubdate data-updated="true">Oct 14<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/10/14/fsharp-for-screen-scraping#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of the many things F# is great for is screen scraping. Here&#8217;s why:</p>

<ul>
<li>Downloading multiple pages asynchronously and in parallel is trivial with F#&#8217;s async support</li>
<li>Navigating the HTML DOM is a great fit for higher order data processing combined with partial application</li>
<li>F# Interactive really shines in iterative processes like this, where you try something out, see it didn&#8217;t work quite well, and keep adjusting until you get it right. Doing a full compile-run cycle on each iteration instead of simply evaluating in the REPL would make this task take much more time-consuming</li>
</ul>


<p><a href="http://htmlagilitypack.codeplex.com/">Html Agility Pack</a> is the obvious candidate to use for screen scraping in .NET, but like other LINQ-like libraries that rely heavily on extension methods, its API isn&#8217;t ideal for use in F#. A simple wrapper will take care of that problem:</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2013/10/14/fsharp-for-screen-scraping">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/07/21/fsharp-data-1-1-9-released">FSharp.Data 1.1.9 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-07-21T22:14:00+01:00" pubdate data-updated="true">Jul 21<span>st</span>, 2013</time>
        
         | <a href="/blog/2013/07/21/fsharp-data-1-1-9-released#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>We&#8217;ve just released version <a href="http://www.nuget.org/packages/FSharp.Data/1.1.9">1.1.9</a> of <a href="http://fsharp.github.io/FSharp.Data/">FSharp.Data</a>, and I realized we&#8217;ve not been announcing new releases since version 1.1.1 when Tomas <a href="http://tomasp.net/blog/fsharp-data.aspx">first announced it</a>, so I though I&#8217;d rectify that. In addition to bug fixes, here what&#8217;s has been added to FSharp.Data since then:</p>

<ul>
<li>The behaviour of CsvProvider can be fine tuned by using the HasHeaders, Schema, IgnoreErrors, SafeMode, and PreferOptionals parameters. See the CsvProvider documentation <a href="http://fsharp.github.io/FSharp.Data/library/CsvProvider.html">here</a>.</li>
<li>The CSV Parser and Reader can now be used standalone. See the CsvFile documentation <a href="http://fsharp.github.io/FSharp.Data/library/CsvFile.html">here</a>.</li>
<li>Guid types are now supported in CsvProvider, JsonProvider, and XmlProvider.</li>
<li>Support to disable caching for CSV files too big to fit in memory.</li>
<li>Support for cookies, binary files and client certificates in FSharp.Net.Http.</li>
<li>Save, Filter, Take, TakeWhile, Skip, SkipWhile, and Truncate operations for CsvProvider and CsvFile.</li>
<li>Support for Windows Phone 7.</li>
</ul>


<p>There&#8217;s still a lot of room for improvement, and we love pull requests, so please contribute, even if it&#8217;s only fixing a typo in the docs. A getting started guide is available <a href="http://fsharp.github.io/FSharp.Data/contributing.html">here</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/05/13/building-type-providers-part1">Building Type Providers - Part 1</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-05-13T00:17:00+01:00" pubdate data-updated="true">May 13<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/05/13/building-type-providers-part1#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Type Providers are the biggest new feature of F# 3.0. They allow us to leverage the power of the static type system in areas that have typically been the territory of dynamic languages and stringly typing. A picture is worth a thousand words, so here&#8217;s 12 pictures that show type providers in action:</p>

<blockquote><p><a href="http://blogs.msdn.com/b/dsyme/archive/2013/01/30/twelve-type-providers-in-pictures.aspx">All your types are belong to us</a></p></blockquote>

<p>There are already several good samples and articles about using type providers, but there still isn&#8217;t a lot about creating type providers. Having worked recently on <a href="http://fsharp.github.com/FSharp.Data/">FSharp.Data</a> I decided to share some tips about building type providers.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2013/05/13/building-type-providers-part1">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/24/fsharp-windows-phone-7-visual-studio-2012">F#, Windows Phone 7 & Visual Studio 2012</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-24T00:00:00+00:00" pubdate data-updated="true">Feb 24<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/02/24/fsharp-windows-phone-7-visual-studio-2012#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>F# 2.0 supported Silverlight 4, Silverlight 5, and Windows Phone 7.1, as several versions of FSharp.Core.dll were
shipped as part of the standalone F# redistribution. There were even some nice <a href="http://blogs.msdn.com/b/dsyme/archive/2010/08/20/f-windows-phone-7-silverlight-templates-now-on-visual-studio-gallery.aspx">Visual Studio 2010 templates</a> made by <a href="http://bloggemdano.blogspot.co.uk/">Daniel Mohl</a>.</p>

<p>In F# 3.0 there is no standalone redistributable package anymore, and Visual Studio 2012 only ships with two versions of FSharp.Core.dll: the full .NET 4.5 version, and a portable class library version targeting Profile47 (which includes .NET 4.5, Silverlight 5.0, and .NET for Windows Store apps).</p>

<p>I tried to create versions for Windows Phone 7 and for Profile88 (which additionally includes .NET 4.0, Silverlight 4.0, and Windows Phone 7.1) from the <a href="https://github.com/fsharp/fsharp">source code</a>, and I even got them to <a href="https://github.com/fsharp/fsharp/pull/102">compile</a>, but unfortunately I still get a bunch of Invalid Program exceptions at runtime when running on the emulator or on the device for both versions.</p>

<p>So I tried another approach - to reuse the FSharp.Core.dll version from F# 2.0 - and it seems to work just fine. Type providers and other new F# 3.0 features that depend on the library won&#8217;t work, but at least we can use Visual Studio 2012 and some of the features like the triple quotes.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2013/02/24/fsharp-windows-phone-7-visual-studio-2012">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/27/f-as-a-octavematlab-replacement-for-machine-learning">F# as a Octave/Matlab Replacement for Machine Learning</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-27T00:00:00+01:00" pubdate data-updated="true">Oct 27<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/27/f-as-a-octavematlab-replacement-for-machine-learning#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
	<strong>EDIT</strong>: As another version of the ml-class course has started, I&#39;ve made the repository private</p>
<p>
	Back when I was in college, I took three different courses that dealt with subjects related to machine learning and data mining. Although I didn&rsquo;t lose interest on those matters, my work has led me in a totally unrelated direction, so I haven&rsquo;t exercised any of that knowledge in about eight years or so. A few weeks ago, I stumbled upon Stanford&rsquo;s online class on <a href="http://www.ml-class.org">Machine Learning</a> and decided to enroll. I want to revive many of the things I have forgotten and try to put them into practice, as nowadays it&rsquo;s very easy to access large amounts of interesting data from all kinds of online sources.</p>
<p>
	The programming exercises of this class are supposed to be done in Octave or Matlab, and while I understand the advantages of these tools, my past experience (where all the exercises and projects were done either with SAS or with Matlab) shows me that not using a general purpose programming languages doesn&rsquo;t help a lot in turning academic exercises into real world programs. As professor Andrew Ng said in the introduction, one of the goals of the class is for us to put machine learning into practice in real world problems we care about, so I decided that I&rsquo;ll implement all the algorithms and exercises in F#.</p>
    </div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2011/10/27/f-as-a-octavematlab-replacement-for-machine-learning">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/02/introducing-presharp">Introducing PreSharp</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-02T00:00:00+01:00" pubdate data-updated="true">Oct 2<span>nd</span>, 2011</time>
        
         | <a href="/blog/2011/10/02/introducing-presharp#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Background</h3>  <p>Back in 2004, I was doing some code-generation work as part of the <a href="http://www.gsd.inesc-id.pt/project-pages/past-projects/obiwan">OBIWAN</a> project. When I started, CodeDom was being used to do the work, but I really didnt like it because it made the generator code very hard to read and modify. Realistically, I would not need to support any other language than C#, so I started looking for alternatives. <a href="http://www.codesmithtools.com/product/generator">CodeSmith</a> was very popular at the time for generating type-safe collections (.NET 2.0 generics didnt exist yet), but it was targeted at one-shot generations, and not at creating code generation code. Then I found a very simple tool named <a href="http://web.archive.org/web/20060726075638/http://www.inmetrix.com/">CodeGen</a> that appealed to me. I had been playing around with the <a href="http://www.boost.org/doc/libs/?view=category_Preprocessor">Boost Preprocessor library</a> recently, so I really liked the idea of using the preprocessor. I did a few tweaks to it and was able to use it for my needs at the time. Later on, around mid-2007, I needed to do code-generation again, so I took this tool and added a good amount of more power to it. At this time, it was very far apart from the original code, so I re-baptized it as PreSharp and published it to CodePlex. I never got around to do any documentation for it, so Im making this post to try to compensate for that. I also moved the project recently from CodePlex to <a href="https://github.com/ovatsus/PreSharp">GitHub</a>.</p>
</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2011/10/02/introducing-presharp">Read on &rarr;</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About me</h1>
  <p>I&#8217;m a Software Developer interested in Functional Programming, Machine Learning, and User Experience Design</p>
  <iframe src="http://githubbadge.appspot.com/badge/ovatsus?a=0" style="border: 0;height: 112px;width: 200px;overflow: hidden;" frameBorder=0></iframe>
</section>
<section>
  <h1>Projects</h1>
  <ul>
    <li><a href="http://fsharp.github.io/FSharp.Data/">FSharp.Data</a></li>
    <li><a href="http://windowsphone.com/s?appId=ef62d461-861c-4a9f-9198-8768532cc6aa"><img src="https://f.cloud.github.com/assets/738761/901479/21504cbe-fb80-11e2-8282-8331c5465d67.png" style="margin:-7px 0px -7px -7px;width:40px;vertical-align:middle;height:40px;border:0;box-shadow:none" />UK Trains</a></li>
    <li><a href="http://windowsphone.com/s?appId=aca60941-2945-49e7-afd2-adbe5625df12"><img src="https://f.cloud.github.com/assets/738761/901479/21504cbe-fb80-11e2-8282-8331c5465d67.png" style="margin:-7px 0px -7px -7px;width:40px;vertical-align:middle;height:40px;border:0;box-shadow:none" />Learn On The Go</a></li>
  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/03/22/maintaining-backwards-compatibility-when-changing-apis-in-fsharp">Maintaining backwards compatibility when changing APIs in F#</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/21/fsharp-named-union-fields">F# named union fields</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/10/fsharp-data-2-0-0-released">FSharp.Data 2.0.0 released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/10/higher-order-list-operations-across-languages">Higher order list operations across languages</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/10/14/fsharp-for-screen-scraping">F# for Screen Scraping</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Tags</h1>
  <span id="tag-cloud">
    <a href='/blog/tags/ajax' style='font-size: 106.0%'>AJAX</a> <a href='/blog/tags/blogging' style='font-size: 106.0%'>Blogging</a> <a href='/blog/tags/code-generation' style='font-size: 106.0%'>Code Generation</a> <a href='/blog/tags/css' style='font-size: 106.0%'>CSS</a> <a href='/blog/tags/f-' style='font-size: 160.0%'>F#</a> <a href='/blog/tags/htmlagilitypack' style='font-size: 106.0%'>HtmlAgilityPack</a> <a href='/blog/tags/linq' style='font-size: 118.0%'>LINQ</a> <a href='/blog/tags/machine-learning' style='font-size: 106.0%'>Machine Learning</a> <a href='/blog/tags/msmq' style='font-size: 106.0%'>MSMQ</a> <a href='/blog/tags/outsystems' style='font-size: 154.0%'>OutSystems</a> <a href='/blog/tags/presharp' style='font-size: 106.0%'>PreSharp</a> <a href='/blog/tags/screen-scraping' style='font-size: 106.0%'>Screen Scraping</a> <a href='/blog/tags/type-providers' style='font-size: 118.0%'>Type Providers</a> <a href='/blog/tags/windows-phone' style='font-size: 106.0%'>Windows Phone</a> <a href='/blog/tags/word' style='font-size: 106.0%'>Word</a> <a href='/blog/tags/wpf' style='font-size: 112.0%'>WPF</a> <a href='/blog/tags/xml' style='font-size: 106.0%'>XML</a> 
  </span>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Gustavo Guerra -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
  - <span class="credit">Theme by <a href="http://www.gehaxelt.in">Gehaxelt</a></span>
  <span class="credit">and <a href="http://www.it-solutions-neef.de">IT Solutions Neef</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'codebesideblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
