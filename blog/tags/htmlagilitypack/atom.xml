<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: HtmlAgilityPack | Functional Flow]]></title>
  <link href="http://functionalflow.co.uk/blog/tags/htmlagilitypack/atom.xml" rel="self"/>
  <link href="http://functionalflow.co.uk/"/>
  <updated>2014-08-11T14:10:30+01:00</updated>
  <id>http://functionalflow.co.uk/</id>
  <author>
    <name><![CDATA[Gustavo Guerra]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[F# for Screen Scraping]]></title>
    <link href="http://functionalflow.co.uk/blog/2013/10/14/fsharp-for-screen-scraping"/>
    <updated>2013-10-14T23:58:00+01:00</updated>
    <id>http://functionalflow.co.uk/blog/2013/10/14/fsharp-for-screen-scraping</id>
    <content type="html"><![CDATA[<p>One of the many things F# is great for is screen scraping. Here's why:</p>

<ul>
<li>Downloading multiple pages asynchronously and in parallel is trivial with F#'s async support</li>
<li>Navigating the HTML DOM is a great fit for higher order data processing combined with partial application</li>
<li>F# Interactive really shines in iterative processes like this, where you try something out, see it didn't work quite well, and keep adjusting until you get it right. Doing a full compile-run cycle on each iteration instead of simply evaluating in the REPL would make this task take much more time-consuming</li>
</ul>


<p><a href="http://htmlagilitypack.codeplex.com/">Html Agility Pack</a> is the obvious candidate to use for screen scraping in .NET, but like other LINQ-like libraries that rely heavily on extension methods, its API isn't ideal for use in F#. A simple wrapper will take care of that problem:</p>

<!-- More -->


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>An F# wrapper for HtmlAgilityPack - HtmlAgilityPack.FSharp.fs </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">module</span> <span class="nn">HtmlAgilityPack</span><span class="p">.</span><span class="nc">FSharp</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">open</span> <span class="nc">HtmlAgilityPack</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">type</span> <span class="nc">HtmlNode</span> <span class="k">with</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">member</span> <span class="n">x</span><span class="o">.</span><span class="nc">FollowingSibling</span> <span class="n">name</span> <span class="o">=</span>
</span><span class='line'>    <span class="k">let</span> <span class="n">sibling</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="nc">NextSibling</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">sibling</span> <span class="o">=</span> <span class="k">null</span> <span class="k">then</span>
</span><span class='line'>        <span class="k">null</span>
</span><span class='line'>    <span class="k">elif</span> <span class="n">sibling</span><span class="o">.</span><span class="nc">Name</span> <span class="o">=</span> <span class="n">name</span> <span class="k">then</span>
</span><span class='line'>        <span class="n">sibling</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>        <span class="n">sibling</span><span class="o">.</span><span class="nc">FollowingSibling</span> <span class="n">name</span>
</span><span class='line'>
</span><span class='line'><span class="k">member</span> <span class="n">x</span><span class="o">.</span><span class="nc">FollowingSiblings</span> <span class="n">name</span> <span class="o">=</span> <span class="n">seq</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">let</span> <span class="n">sibling</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="nc">NextSibling</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">sibling</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="k">null</span> <span class="k">then</span>
</span><span class='line'>        <span class="k">if</span> <span class="n">sibling</span><span class="o">.</span><span class="nc">Name</span> <span class="o">=</span> <span class="n">name</span> <span class="k">then</span>
</span><span class='line'>            <span class="k">yield</span> <span class="n">sibling</span>
</span><span class='line'>        <span class="k">yield</span><span class="o">!</span> <span class="n">sibling</span><span class="o">.</span><span class="nc">FollowingSiblings</span> <span class="n">name</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">member</span> <span class="n">x</span><span class="o">.</span><span class="nc">PrecedingSibling</span> <span class="n">name</span> <span class="o">=</span>
</span><span class='line'>    <span class="k">let</span> <span class="n">sibling</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="nc">PreviousSibling</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">sibling</span> <span class="o">=</span> <span class="k">null</span> <span class="k">then</span>
</span><span class='line'>        <span class="k">null</span>
</span><span class='line'>    <span class="k">elif</span> <span class="n">sibling</span><span class="o">.</span><span class="nc">Name</span> <span class="o">=</span> <span class="n">name</span> <span class="k">then</span>
</span><span class='line'>        <span class="n">sibling</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>        <span class="n">sibling</span><span class="o">.</span><span class="nc">PrecedingSibling</span> <span class="n">name</span>
</span><span class='line'>
</span><span class='line'><span class="k">member</span> <span class="n">x</span><span class="o">.</span><span class="nc">PrecedingSiblings</span> <span class="n">name</span> <span class="o">=</span> <span class="n">seq</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">let</span> <span class="n">sibling</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="nc">PreviousSibling</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">sibling</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="k">null</span> <span class="k">then</span>
</span><span class='line'>        <span class="k">if</span> <span class="n">sibling</span><span class="o">.</span><span class="nc">Name</span> <span class="o">=</span> <span class="n">name</span> <span class="k">then</span>
</span><span class='line'>            <span class="k">yield</span> <span class="n">sibling</span>
</span><span class='line'>        <span class="k">yield</span><span class="o">!</span> <span class="n">sibling</span><span class="o">.</span><span class="nc">PrecedingSiblings</span> <span class="n">name</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">parent</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">node</span><span class="o">.</span><span class="nc">ParentNode</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">element</span> <span class="n">name</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">node</span><span class="o">.</span><span class="nc">Element</span> <span class="n">name</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">elements</span> <span class="n">name</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">node</span><span class="o">.</span><span class="nc">Elements</span> <span class="n">name</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">descendants</span> <span class="n">name</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">node</span><span class="o">.</span><span class="nc">Descendants</span> <span class="n">name</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">descendantsAndSelf</span> <span class="n">name</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">node</span><span class="o">.</span><span class="nc">DescendantsAndSelf</span> <span class="n">name</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">ancestors</span> <span class="n">name</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">node</span><span class="o">.</span><span class="nc">Ancestors</span> <span class="n">name</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">ancestorsAndSelf</span> <span class="n">name</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">node</span><span class="o">.</span><span class="nc">AncestorsAndSelf</span> <span class="n">name</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">followingSibling</span> <span class="n">name</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">node</span><span class="o">.</span><span class="nc">FollowingSibling</span> <span class="n">name</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">followingSiblings</span> <span class="n">name</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">node</span><span class="o">.</span><span class="nc">FollowingSiblings</span> <span class="n">name</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">precedingSibling</span> <span class="n">name</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">node</span><span class="o">.</span><span class="nc">PrecedingSibling</span> <span class="n">name</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">precedingSiblings</span> <span class="n">name</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">node</span><span class="o">.</span><span class="nc">PrecedingSiblings</span> <span class="n">name</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="k">inline</span> <span class="n">innerText</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">node</span><span class="o">.</span><span class="nc">InnerText</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="k">inline</span> <span class="n">attr</span> <span class="n">name</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">node</span><span class="o">.</span><span class="nc">GetAttributeValue</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="s2">&quot;&quot;</span><span class="o">)</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="k">inline</span> <span class="o">(?)</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="n">name</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">attr</span> <span class="n">name</span> <span class="n">node</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="k">inline</span> <span class="n">hasAttr</span> <span class="n">name</span> <span class="n">value</span> <span class="n">node</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">attr</span> <span class="n">name</span> <span class="n">node</span> <span class="o">=</span> <span class="n">value</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="k">inline</span> <span class="n">hasId</span> <span class="n">value</span> <span class="n">node</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">hasAttr</span> <span class="s2">&quot;id&quot;</span> <span class="n">value</span> <span class="n">node</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="k">inline</span> <span class="n">hasClass</span> <span class="n">value</span> <span class="n">node</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">hasAttr</span> <span class="s2">&quot;class&quot;</span> <span class="n">value</span> <span class="n">node</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="k">inline</span> <span class="n">hasText</span> <span class="n">value</span> <span class="o">(</span><span class="n">node</span> <span class="o">:</span> <span class="nc">HtmlNode</span><span class="o">)</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">node</span><span class="o">.</span><span class="nc">InnerText</span> <span class="o">=</span> <span class="n">value</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">createDoc</span> <span class="n">html</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">doc</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HtmlDocument</span><span class="bp">()</span>
</span><span class='line'><span class="n">doc</span><span class="o">.</span><span class="nc">LoadHtml</span> <span class="n">html</span>
</span><span class='line'><span class="n">doc</span><span class="o">.</span><span class="nc">DocumentNode</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>When we leave the "target" of an operation as the last parameter of a function, we can leverage partial application to remove the need to create anonymous lambdas when using higher order functions such as the ones needed for DOM traversing.</p>

<p>In this case, by taking the <code>this</code> parameter of the C# methods and putting it as the last parameter of our wrapper functions <code>elements</code>, <code>descendants</code>, <code>innerText</code>, etc., our code is now much easier to read and to understand than if we used the Html Agility Pack methods directly.</p>

<p>As an example, here is a small script that I used when developing one of my Windows Phone apps to get the list if all the rail stations in Ireland together with their coordinates:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>IrelandRailStations.fsx </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">r</span> <span class="s2">&quot;System.Net&quot;</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">r</span> <span class="s2">&quot;../lib/portable/FSharp.Data.dll&quot;</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">r</span> <span class="s2">&quot;../packages/HtmlAgilityPack-PCL.1.4.6/lib/HtmlAgilityPack-PCL.dll&quot;</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">load</span> <span class="s2">&quot;HtmlAgilityPack.FSharp.fs&quot;</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// get a page that lists the stations that start with firstLetter</span>
</span><span class='line'><span class="k">let</span> <span class="n">getStationListPage</span> <span class="n">firstLetter</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="s2">&quot;http://www.irishrail.ie/cat_stations_list.jsp?letter=&quot;</span> <span class="o">+</span> <span class="o">(</span><span class="kt">string</span> <span class="n">firstLetter</span><span class="o">)</span>
</span><span class='line'><span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Http</span><span class="p">.</span><span class="nc">AsyncRequestString</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// get all the links to stations inside the &lt;ul class=&quot;results&quot;&gt;</span>
</span><span class='line'><span class="k">let</span> <span class="n">getStations</span> <span class="n">stationListPage</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">stationListPage</span>
</span><span class='line'><span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">createDoc</span>
</span><span class='line'><span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">descendants</span> <span class="s2">&quot;ul&quot;</span>
</span><span class='line'><span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">filter</span> <span class="o">(</span><span class="n">hasClass</span> <span class="s2">&quot;results&quot;</span><span class="o">)</span>
</span><span class='line'><span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">head</span>
</span><span class='line'><span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">descendants</span> <span class="s2">&quot;a&quot;</span>
</span><span class='line'><span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="n">attr</span> <span class="s2">&quot;href&quot;</span><span class="o">)</span>
</span><span class='line'><span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">toArray</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// get the page for a station</span>
</span><span class='line'><span class="k">let</span> <span class="n">getStationPage</span> <span class="n">station</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="s2">&quot;http://www.irishrail.ie/&quot;</span> <span class="o">+</span> <span class="n">station</span>
</span><span class='line'><span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Http</span><span class="p">.</span><span class="nc">AsyncRequestString</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// get the latitude and longitude of a station from the google maps link in the station page</span>
</span><span class='line'><span class="k">let</span> <span class="n">getCoordinates</span> <span class="n">stationPage</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">googleMapsLink</span> <span class="o">=</span>
</span><span class='line'>    <span class="n">stationPage</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">createDoc</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">descendants</span> <span class="s2">&quot;div&quot;</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">filter</span> <span class="o">(</span><span class="n">hasId</span> <span class="s2">&quot;map-ordnance&quot;</span><span class="o">)</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">head</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">followingSibling</span> <span class="s2">&quot;ul&quot;</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">descendants</span> <span class="s2">&quot;a&quot;</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">head</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">attr</span> <span class="s2">&quot;href&quot;</span>
</span><span class='line'><span class="k">let</span> <span class="n">split</span> <span class="o">(</span><span class="n">c</span><span class="o">:</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span><span class="o">:</span><span class="kt">string</span><span class="o">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="nc">Split</span> <span class="n">c</span>
</span><span class='line'><span class="k">let</span> <span class="o">[|</span> <span class="s2">&quot;ll&quot;</span> <span class="o">;</span> <span class="n">coords</span> <span class="o">|]</span> <span class="o">=</span>
</span><span class='line'>    <span class="nc">Uri</span><span class="o">(</span><span class="n">googleMapsLink</span><span class="o">).</span><span class="nc">Query</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">split</span> <span class="k">&#39;</span><span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="k">&#39;</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="n">split</span> <span class="sc">&#39;=&#39;</span><span class="o">)</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">filter</span> <span class="o">(</span><span class="nn">Seq</span><span class="p">.</span><span class="n">head</span> <span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="o">(=)</span> <span class="s2">&quot;ll&quot;</span><span class="o">)</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">head</span>
</span><span class='line'><span class="k">let</span> <span class="o">[|</span> <span class="n">lat</span><span class="o">;</span> <span class="n">long</span> <span class="o">|]</span> <span class="o">=</span> <span class="n">coords</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">split</span> <span class="sc">&#39;,&#39;</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Array</span><span class="p">.</span><span class="n">map</span> <span class="kt">float</span>
</span><span class='line'><span class="n">lat</span><span class="o">,</span> <span class="n">long</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">stationsAndCoords</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">stations</span> <span class="o">=</span>
</span><span class='line'>    <span class="o">[</span><span class="sc">&#39;A&#39;</span><span class="o">..</span><span class="sc">&#39;Z&#39;</span><span class="o">]</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span> <span class="n">getStationListPage</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Async</span><span class="p">.</span><span class="nc">Parallel</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Async</span><span class="p">.</span><span class="nc">RunSynchronously</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Array</span><span class="p">.</span><span class="n">collect</span> <span class="n">getStations</span>
</span><span class='line'><span class="k">let</span> <span class="n">lat</span><span class="o">,</span> <span class="n">long</span> <span class="o">=</span>
</span><span class='line'>    <span class="n">stations</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span> <span class="n">getStationPage</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Async</span><span class="p">.</span><span class="nc">Parallel</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Async</span><span class="p">.</span><span class="nc">RunSynchronously</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Array</span><span class="p">.</span><span class="n">map</span> <span class="n">getCoordinates</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Array</span><span class="p">.</span><span class="n">unzip</span>
</span><span class='line'><span class="k">let</span> <span class="n">stations</span> <span class="o">=</span>
</span><span class='line'>    <span class="n">stations</span>
</span><span class='line'>    <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Array</span><span class="p">.</span><span class="n">map</span> <span class="nn">Uri</span><span class="p">.</span><span class="nc">UnescapeDataString</span>
</span><span class='line'><span class="nn">Array</span><span class="p">.</span><span class="n">zip3</span> <span class="n">stations</span> <span class="n">lat</span> <span class="n">long</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Output:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">val</span> <span class="n">stationsAndCoords</span> <span class="o">:</span> <span class="o">(</span><span class="kt">string</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span><span class="o">)</span> <span class="bp">[]</span> <span class="o">=</span>
</span><span class='line'>  <span class="o">[|(</span><span class="s2">&quot;Adamstown&quot;</span><span class="o">,</span> <span class="mi">53</span><span class="o">.</span><span class="mi">335285</span><span class="o">,</span> <span class="o">-</span><span class="mi">6</span><span class="o">.</span><span class="mi">4523325</span><span class="o">);</span> <span class="o">(</span><span class="s2">&quot;Ardrahan&quot;</span><span class="o">,</span> <span class="mi">53</span><span class="o">.</span><span class="mi">157177</span><span class="o">,</span> <span class="o">-</span><span class="mi">8</span><span class="o">.</span><span class="mi">814831</span><span class="o">);&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;(</span><span class="s2">&quot;Arklow&quot;</span><span class="o">,</span> <span class="mi">52</span><span class="o">.</span><span class="mi">793163</span><span class="o">,</span> <span class="o">-</span><span class="mi">6</span><span class="o">.</span><span class="mi">159939</span><span class="o">);</span> <span class="o">(</span><span class="s2">&quot;Ashtown&quot;</span><span class="o">,</span> <span class="mi">53</span><span class="o">.</span><span class="mi">37552</span><span class="o">,</span> <span class="o">-</span><span class="mi">6</span><span class="o">.</span><span class="mi">3313503</span><span class="o">);</span>
</span><span class='line'><span class="o">(</span><span class="s2">&quot;Athenry&quot;</span><span class="o">,</span> <span class="mi">53</span><span class="o">.</span><span class="mi">30153</span><span class="o">,</span> <span class="o">-</span><span class="mi">8</span><span class="o">.</span><span class="mi">748547</span><span class="o">);</span> <span class="o">(</span><span class="s2">&quot;Athlone&quot;</span><span class="o">,</span> <span class="mi">53</span><span class="o">.</span><span class="mi">427322</span><span class="o">,</span> <span class="o">-</span><span class="mi">7</span><span class="o">.</span><span class="mi">9368286</span><span class="o">);</span>
</span><span class='line'><span class="o">(</span><span class="s2">&quot;Athy&quot;</span><span class="o">,</span> <span class="mi">52</span><span class="o">.</span><span class="mi">991997</span><span class="o">,</span> <span class="o">-</span><span class="mi">6</span><span class="o">.</span><span class="mi">976196</span><span class="o">);</span> <span class="o">(</span><span class="s2">&quot;Attymon&quot;</span><span class="o">,</span> <span class="mi">53</span><span class="o">.</span><span class="mi">321205</span><span class="o">,</span> <span class="o">-</span><span class="mi">8</span><span class="o">.</span><span class="mi">606078</span><span class="o">);</span>
</span><span class='line'><span class="o">...|]</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>You can also see that the same pattern was used for making the <code>String.Split</code> function play well with partial application.</p>

<p>Another neat feature of F# for scripting (I wouldn't recommend incorporating it in production code), is the ability to de-structure arrays in one liners, as done in <code>let [| "ll" ; coords |] =</code> and <code>let [| lat; long |] =</code>. The compiler will emit a warning saying that the match is not exhaustive, telling us that this might backfire if there are less than two elements in the array, but for the purpose of a one shot script to download some data it's fine.</p>

<p>And to give a second example, here's a snippet from my Learn On The Go app that processes the html of the lecture videos page of a Coursera course:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">let</span> <span class="n">lectureSections</span> <span class="o">=&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">let</span> <span class="n">trimAndUnescape</span> <span class="o">(</span><span class="n">text</span><span class="o">:</span><span class="kt">string</span><span class="o">)</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="nc">Replace</span><span class="o">(</span><span class="s2">&quot;&amp;amp;nbsp;&quot;</span><span class="o">,</span> <span class="s2">&quot;&quot;</span><span class="o">).</span><span class="nc">Trim</span><span class="bp">()</span><span class="o">.</span><span class="nc">Replace</span><span class="o">(</span><span class="s2">&quot;&amp;amp;amp;&quot;</span><span class="o">,</span> <span class="s2">&quot;&amp;amp;&quot;</span><span class="o">).</span><span class="nc">Replace</span><span class="o">(</span><span class="s2">&quot;&amp;amp;quot;&quot;</span><span class="o">,</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">).</span><span class="nc">Replace</span><span class="o">(</span><span class="s2">&quot;apos;&quot;</span><span class="o">,</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">).</span><span class="nc">Replace</span><span class="o">(</span><span class="s2">&quot;&amp;amp;lt;&quot;</span><span class="o">,</span> <span class="s2">&quot;&amp;lt;&quot;</span><span class="o">).</span><span class="nc">Replace</span><span class="o">(</span><span class="s2">&quot;&amp;amp;gt;&quot;</span><span class="o">,</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="o">)</span>
</span><span class='line'><span class="k">let</span> <span class="n">endsWith</span> <span class="n">suffix</span> <span class="o">(</span><span class="n">text</span><span class="o">:</span><span class="kt">string</span><span class="o">)</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="nc">EndsWith</span> <span class="n">suffix</span>
</span><span class='line'><span class="n">createDoc</span> <span class="n">lecturesHtmlStr</span>
</span><span class='line'><span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">descendants</span> <span class="s2">&quot;h3&quot;</span>
</span><span class='line'><span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="n">h3</span> <span class="o">-&amp;</span><span class="n">gt</span><span class="o">;</span>
</span><span class='line'>    <span class="k">let</span> <span class="n">title</span> <span class="o">=</span> <span class="n">h3</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">innerText</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">trimAndUnescape</span>
</span><span class='line'>    <span class="k">let</span> <span class="n">completed</span> <span class="o">=</span> <span class="n">h3</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">parent</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">hasClass</span> <span class="s2">&quot;course-item-list-header contracted&quot;</span>
</span><span class='line'>    <span class="k">let</span> <span class="n">ul</span> <span class="o">=</span>
</span><span class='line'>        <span class="n">h3</span>
</span><span class='line'>        <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">parent</span>
</span><span class='line'>        <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">followingSibling</span> <span class="s2">&quot;ul&quot;</span>
</span><span class='line'>    <span class="n">ul</span><span class="o">,</span> <span class="n">title</span><span class="o">,</span> <span class="n">completed</span><span class="o">)</span>
</span><span class='line'><span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">filter</span> <span class="o">(</span><span class="k">fun</span> <span class="o">(</span><span class="n">ul</span><span class="o">,</span> <span class="o">_,</span> <span class="o">_)</span> <span class="o">-&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ul</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="k">null</span><span class="o">)</span>
</span><span class='line'><span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="o">(</span><span class="n">ul</span><span class="o">,</span> <span class="n">title</span><span class="o">,</span> <span class="n">completed</span><span class="o">)</span> <span class="o">-&amp;</span><span class="n">gt</span><span class="o">;</span>
</span><span class='line'>    <span class="k">let</span> <span class="n">lectures</span> <span class="o">=</span>
</span><span class='line'>        <span class="n">ul</span>
</span><span class='line'>        <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">elements</span> <span class="s2">&quot;li&quot;</span>
</span><span class='line'>        <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="n">element</span> <span class="s2">&quot;a&quot;</span><span class="o">)</span>
</span><span class='line'>        <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="n">a</span> <span class="o">-&amp;</span><span class="n">gt</span><span class="o">;</span>
</span><span class='line'>            <span class="k">let</span> <span class="n">id</span> <span class="o">=</span> <span class="n">a</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">attr</span> <span class="s2">&quot;data-lecture-id&quot;</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="kt">int</span>
</span><span class='line'>            <span class="k">let</span> <span class="n">title</span> <span class="o">=</span> <span class="n">innerText</span> <span class="n">a</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">trimAndUnescape</span>
</span><span class='line'>            <span class="k">let</span> <span class="n">quizAttemptedSpan</span> <span class="o">=</span> <span class="n">a</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">elements</span> <span class="s2">&quot;span&quot;</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">tryFind</span> <span class="o">(</span><span class="n">hasClass</span> <span class="s2">&quot;label label-success&quot;</span><span class="o">)</span>
</span><span class='line'>            <span class="k">let</span> <span class="n">title</span><span class="o">,</span> <span class="n">quizAttempted</span> <span class="o">=</span>
</span><span class='line'>                <span class="k">match</span> <span class="n">quizAttemptedSpan</span> <span class="k">with</span>
</span><span class='line'>                <span class="o">|</span> <span class="nc">Some</span> <span class="n">span</span> <span class="o">-&amp;</span><span class="n">gt</span><span class="o">;</span>
</span><span class='line'>                    <span class="n">title</span><span class="o">.</span><span class="nc">Replace</span><span class="o">(</span><span class="n">trimAndUnescape</span> <span class="n">span</span><span class="o">.</span><span class="nc">InnerText</span><span class="o">,</span> <span class="s2">&quot;&quot;</span><span class="o">).</span><span class="nc">Trim</span><span class="bp">()</span><span class="o">,</span> <span class="bp">true</span>
</span><span class='line'>                <span class="o">|</span> <span class="nc">None</span> <span class="o">-&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">title</span><span class="o">,</span> <span class="bp">false</span>
</span><span class='line'>            <span class="k">let</span> <span class="n">videoUrl</span> <span class="o">=</span> <span class="n">a</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">attr</span> <span class="s2">&quot;data-modal-iframe&quot;</span>
</span><span class='line'>            <span class="k">let</span> <span class="n">lectureNotesUrl</span> <span class="o">=</span>
</span><span class='line'>                <span class="k">let</span> <span class="n">urls</span> <span class="o">=</span> <span class="n">a</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">followingSibling</span> <span class="s2">&quot;div&quot;</span>
</span><span class='line'>                             <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">elements</span> <span class="s2">&quot;a&quot;</span>
</span><span class='line'>                             <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="n">attr</span> <span class="s2">&quot;href&quot;</span><span class="o">)</span>
</span><span class='line'>                <span class="k">match</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">tryFind</span> <span class="o">(</span><span class="n">endsWith</span> <span class="s2">&quot;.pdf&quot;</span><span class="o">)</span> <span class="n">urls</span> <span class="k">with</span>
</span><span class='line'>                <span class="o">|</span> <span class="nc">Some</span> <span class="n">url</span> <span class="o">-&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">url</span>
</span><span class='line'>                <span class="o">|</span> <span class="o">_</span> <span class="o">-&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>            <span class="k">let</span> <span class="n">viewed</span> <span class="o">=</span> <span class="n">a</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">parent</span> <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">hasClass</span> <span class="s2">&quot;viewed&quot;</span>
</span><span class='line'>            <span class="o">{</span> <span class="nc">Id</span> <span class="o">=</span> <span class="n">id</span>
</span><span class='line'>              <span class="nc">Title</span> <span class="o">=</span> <span class="n">title</span>
</span><span class='line'>              <span class="nc">VideoUrl</span> <span class="o">=</span> <span class="n">videoUrl</span>
</span><span class='line'>              <span class="nc">LectureNotesUrl</span> <span class="o">=</span> <span class="n">lectureNotesUrl</span>
</span><span class='line'>              <span class="nc">Viewed</span> <span class="o">=</span> <span class="n">viewed</span>
</span><span class='line'>              <span class="nc">QuizAttempted</span> <span class="o">=</span> <span class="n">quizAttempted</span> <span class="o">})</span>
</span><span class='line'>        <span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">toArray</span>
</span><span class='line'>    <span class="o">{</span> <span class="nc">Title</span> <span class="o">=</span> <span class="n">title</span>
</span><span class='line'>      <span class="nc">Completed</span> <span class="o">=</span> <span class="n">completed</span>
</span><span class='line'>      <span class="nc">Lectures</span> <span class="o">=</span> <span class="n">lectures</span> <span class="o">})</span>
</span><span class='line'><span class="o">|&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">toArray</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>
]]></content>
  </entry>
  
</feed>
